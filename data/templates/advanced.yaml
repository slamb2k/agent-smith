# Advanced Template
# Best for: Complex households with investments, tax optimization, business expenses

metadata:
  template_name: Advanced
  description: Comprehensive tracking with tax optimization and investment management
  target_users: High-income households, business owners, investors

rules:
  # ═══════════════════════════════════════════════════════════
  # INCOME STREAMS
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Salary Income
    patterns: [SALARY, WAGES, EMPLOYER]
    category: Income > Employment
    confidence: 95

  - type: label
    name: Taxable Income
    when:
      categories: [Income > Employment, Income > Business, Income > Rental]
    labels: [Taxable Income, ATO: Income]

  - type: category
    name: Investment Income
    patterns: [DIVIDEND, DISTRIBUTION, INTEREST, INVESTMENT]
    category: Income > Investment
    confidence: 90

  - type: label
    name: Investment Income Tax
    when:
      categories: [Income > Investment]
    labels: [Taxable Income, ATO: Investment, CGT Relevant]

  - type: category
    name: Business Income
    patterns: [INVOICE, CLIENT, BUSINESS]
    category: Income > Business
    confidence: 85

  # ═══════════════════════════════════════════════════════════
  # TAX DEDUCTIBLE EXPENSES
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Home Office
    patterns: [OFFICE SUPPLIES, DESK, CHAIR, MONITOR, OFFICEWORKS]
    category: Work Expenses > Home Office
    confidence: 85

  - type: label
    name: Tax Deductible - Home Office
    when:
      categories: [Work Expenses > Home Office]
    labels: [Tax Deductible, ATO: D2 - Work Expenses]

  - type: category
    name: Professional Development
    patterns: [COURSE, TRAINING, CONFERENCE, SEMINAR, UDEMY, COURSERA]
    category: Work Expenses > Professional Development
    confidence: 90

  - type: label
    name: Tax Deductible - Self Education
    when:
      categories: [Work Expenses > Professional Development]
    labels: [Tax Deductible, ATO: D5 - Self Education]

  - type: category
    name: Work Travel
    patterns: [FLIGHT, HOTEL, ACCOMMODATION]
    accounts: [Work, Business]
    category: Work Expenses > Travel
    confidence: 85

  - type: label
    name: Tax Deductible - Work Travel
    when:
      categories: [Work Expenses > Travel]
    labels: [Tax Deductible, ATO: D1 - Work Travel, Requires Documentation]

  - type: category
    name: Charitable Donations
    patterns: [DONATION, CHARITY, FOUNDATION, GIVIT]
    category: Charity
    confidence: 90

  - type: label
    name: Tax Deductible - Donation
    when:
      categories: [Charity]
    labels: [Tax Deductible, ATO: D9 - Donations, Requires Receipt]

  # ═══════════════════════════════════════════════════════════
  # INVESTMENT MANAGEMENT
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Share Purchase
    patterns: [COMMSEC, ETRADE, SELFWEALTH, SHARE PURCHASE]
    category: Investment > Shares
    confidence: 90

  - type: label
    name: Capital Gains Tracking
    when:
      categories: [Investment > Shares, Investment > Property, Investment > Crypto]
    labels: [CGT Relevant, Investment, Requires Cost Base Tracking]

  - type: category
    name: Investment Fees
    patterns: [PLATFORM FEE, MANAGEMENT FEE, BROKERAGE]
    category: Investment > Fees
    confidence: 85

  - type: label
    name: Tax Deductible - Investment Fees
    when:
      categories: [Investment > Fees]
    labels: [Tax Deductible, ATO: D4 - Investment Management]

  # ═══════════════════════════════════════════════════════════
  # RENTAL PROPERTY
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Rental Property Expenses
    patterns: [PROPERTY MANAGEMENT, MAINTENANCE, REPAIRS]
    accounts: [Investment Property]
    category: Investment > Rental Property > Expenses
    confidence: 85

  - type: label
    name: Tax Deductible - Rental Property
    when:
      categories: [Investment > Rental Property > Expenses]
    labels: [Tax Deductible, ATO: Rental Property, Negative Gearing]

  - type: category
    name: Rental Income
    patterns: [RENT RECEIVED, RENTAL INCOME]
    category: Income > Rental
    confidence: 95

  # ═══════════════════════════════════════════════════════════
  # BUSINESS EXPENSES
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Business Software
    patterns: [SLACK, ADOBE, MICROSOFT, SOFTWARE SUBSCRIPTION]
    accounts: [Business]
    category: Business Expenses > Software
    confidence: 90

  - type: label
    name: Tax Deductible - Business Expense
    when:
      accounts: [Business]
      categories: [Business Expenses > Software, Business Expenses > Equipment]
    labels: [Tax Deductible, Business Expense, GST Claimable]

  # ═══════════════════════════════════════════════════════════
  # CROSS-CATEGORY RULES
  # ═══════════════════════════════════════════════════════════

  - type: label
    name: Large Transaction - Requires Documentation
    when:
      amount_operator: ">"
      amount_value: 1000
    labels: [Large Transaction, Requires Documentation]

  - type: label
    name: End of Financial Year Review
    when:
      categories: [Income > Investment, Work Expenses, Investment, Charity]
    labels: [EOFY Review Required]

  - type: label
    name: Flag Uncategorized
    when:
      uncategorized: true
    labels: [Needs Categorization, Review Required]
