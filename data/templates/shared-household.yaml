# Shared Household Template
# Best for: Couples, roommates, or families with shared expenses

metadata:
  template_name: Shared Household
  description: Manage shared expenses with contributor tracking and approval workflows
  target_users: Couples, roommates, or families sharing bills

rules:
  # ═══════════════════════════════════════════════════════════
  # SHARED EXPENSES - ESSENTIAL
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Shared Groceries
    patterns: [WOOLWORTHS, COLES, ALDI, IGA]
    accounts: [Shared Bills, Joint Account]
    category: Food & Dining > Groceries
    confidence: 95

  - type: label
    name: Shared Essential Expense
    when:
      categories: [Groceries, Utilities, Rent, Insurance]
      accounts: [Shared Bills, Joint Account]
    labels: [Shared Expense, Essential]

  - type: category
    name: Rent/Mortgage
    patterns: [RENT, MORTGAGE, REAL ESTATE]
    category: Housing > Rent
    confidence: 95

  - type: label
    name: Major Shared Expense
    when:
      categories: [Housing > Rent, Housing > Mortgage]
    labels: [Shared Expense, Major, Essential]

  - type: category
    name: Utilities
    patterns: [AGL, ORIGIN, ENERGY, WATER, GAS, TELSTRA, INTERNET]
    category: Bills > Utilities
    confidence: 90

  # ═══════════════════════════════════════════════════════════
  # CONTRIBUTOR TRACKING
  # ═══════════════════════════════════════════════════════════

  - type: label
    name: Person A Contribution
    when:
      accounts: [Shared Bills, Joint Account]
      categories: []  # Applies to all categories
      amount_operator: ">"
      amount_value: 0
    labels: [Contributor: PersonA]

  - type: label
    name: Person B Contribution
    when:
      accounts: [Shared Bills]
      patterns: [PERSONB NAME, TRANSFER FROM PERSONB]
      amount_operator: ">"
      amount_value: 0
    labels: [Contributor: PersonB]

  # ═══════════════════════════════════════════════════════════
  # PERSONAL EXPENSES
  # ═══════════════════════════════════════════════════════════

  - type: category
    name: Personal Groceries
    patterns: [WOOLWORTHS, COLES, ALDI]
    accounts: [Personal, PersonA Account, PersonB Account]
    category: Food & Dining > Groceries
    confidence: 95

  - type: label
    name: Personal Expense
    when:
      accounts: [Personal, PersonA Account, PersonB Account]
    labels: [Personal, Individual]

  # ═══════════════════════════════════════════════════════════
  # APPROVAL WORKFLOWS
  # ═══════════════════════════════════════════════════════════

  - type: label
    name: Needs Approval - Large Shared Purchase
    when:
      accounts: [Shared Bills, Joint Account]
      amount_operator: ">"
      amount_value: 150
    labels: [Needs Approval, Review Required]

  - type: label
    name: Needs Approval - Discretionary Shared
    when:
      accounts: [Shared Bills, Joint Account]
      categories: [Dining Out, Entertainment, Shopping]
    labels: [Needs Approval, Discretionary]

  # ═══════════════════════════════════════════════════════════
  # RECONCILIATION
  # ═══════════════════════════════════════════════════════════

  - type: label
    name: Monthly Reconciliation Item
    when:
      accounts: [Shared Bills, Joint Account]
      categories: [Groceries, Utilities, Dining Out, Entertainment]
    labels: [Monthly Reconciliation]

  - type: label
    name: Flag Uncategorized Shared
    when:
      accounts: [Shared Bills, Joint Account]
      uncategorized: true
    labels: [Needs Categorization, Shared Account]
